<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Freskito's</title>
    <link href="estilos2.css" rel="stylesheet" type="text/css"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Indie+Flower&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/ab3fe7d56f.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
</head>
<body>

    <header class="header">
        <div class="logo">
            <img src="logo freskitos.png" alt=""/>
          
            <nav class="navbar">
                <ul class="nav-links">
                    <li><a href="#">Inicio</a></li>
                </ul>
            </nav>
        </div>    

        <div class="container-user">
          <a href="/Perfil" class="user"><i class="fa-solid fa-user"></i></a>
          <a href="/CarritoCompras" class="shopping"><i class="fa-solid fa-cart-shopping"></i></a>
        </div>  
                 
        
    </header>   
    
    <div class="main-image">
        <img src="Banner.jpg" alt="Banner" class="image"/>
    </div>


    <div class="space"></div>
    <div class="product-text-category">

      <h3>Frutas</h3>

    <section class="product">
      <div class="content product" data-id="1" data-name="sandia" data-price="3.980" data-quantity="1">
        <img src="sandia.jpg" class="card-img-top" alt="sandia"/>
        <div class="card-body">
          <h5 class="card-title">Sandia</h5>
          <h6>$3.980</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="2" data-name="fresa" data-price="8.580" data-quantity="1">
          <img src="/fresa.jpg" class="card-img-top" alt="fresa"/>
        <div class="card-body" >
          <h5 class="card-title">Fresa</h5>
          <h6>$8.580</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="3" data-name="manzana" data-price="8.940" data-quantity="1">
        <img src="manzana.jpg" class="card-img-top" alt="manzana"/>
        <div class="card-body">
          <h5 class="card-title">Manzana</h5>
          <h6>$8.940</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="4" data-name="pera" data-price="9.150" data-quantity="1">
        <img src="pera.jpg" class="card-img-top" alt="pera"/>
        <div class="card-body">
          <h5 class="card-title">Pera</h5>
          <h6>$9.150</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="5" data-name="uva" data-price="13.400" data-quantity="1">
        <img src="uva.jpg" class="card-img-top" alt="uva"/>
        <div class="card-body">
          <h5 class="card-title">Uva</h5>
          <h6>$13.400</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="6" data-name="mandarina" data-price="6.800" data-quantity="1">
        <img src="mandarina.jpg" class="card-img-top" alt="mandarina"/>
        <div class="card-body">
          <h5 class="card-title">Mandarina</h5>
          <h6>$6.800</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="7" data-name="mango" data-price="7.890" data-quantity="1">
        <img src="mango.jpg" class="card-img-top" alt="mango"/>
        <div class="card-body">
          <h5 class="card-title">Mango</h5>
          <h6>$7.890</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="8" data-name="granadilla" data-price="11.380" data-quantity="1">
        <img src="granadilla.jpg" class="card-img-top" alt="granadilla"/>
        <div class="card-body">
          <h5 class="card-title">Granadilla</h5>
          <h6>$11.380</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>
    </section>
  
      <h3>Verduras</h3>
  
    <section class="product">
      <div class="content"  class="product" data-id="9" data-name="cebolla_larga" data-price="4.780" data-quantity="1">
          <img src="cebolla larga.jpg" class="card-img-top" alt="cebolla larga"/>
        <div class="card-body">
          <h5 class="card-title">Cebolla Larga</h5>
          <h6>$4.780</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="10" data-name="cebolla" data-price="1.780" data-quantity="1">
          <img src="cebolla.jpg" class="card-img-top" alt="cebolla"/>
        <div class="card-body">
          <h5 class="card-title">Cebolla</h5>
          <h6>$1.780</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="11" data-name="brocoli" data-price="6.980" data-quantity="1">
          <img src="brocoli.jpg" class="card-img-top" alt="brocoli"/>
        <div class="card-body">
          <h5 class="card-title">Brocoli</h5> 
          <h6>$6.980</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="12" data-name="lechuga" data-price="8.420" data-quantity="1">
          <img src="lechuga.jpg" class="card-img-top" alt="lechuga"/>
        <div class="card-body">
          <h5 class="card-title">lechuga</h5>
          <h6>$8.420</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="13" data-name="espinaca" data-price="2.600" data-quantity="1">
          <img src="espinaca.jpeg" class="card-img-top" alt="espinaca"/>
        <div class="card-body">
          <h5 class="card-title">Espinaca</h5>
          <h6>$2.600</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="14" data-name="repollo" data-price="2.980" data-quantity="1">
          <img src="repollo.jpg" class="card-img-top" alt="repollo"/>
        <div class="card-body">
          <h5 class="card-title">Repollo</h5>
          <h6>$2.980</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="15" data-name="aceitunas" data-price="4.150" data-quantity="1">
        <img src="aceitunas.jpg" class="card-img-top" alt="aceitunas"/>
        <div class="card-body">
          <h5 class="card-title">Aceitunas</h5>
          <h6>$4.150</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="16" data-name="remolacha" data-price="4.600" data-quantity="1">
        <img src="remolacha.jpg" class="card-img-top" alt="remolacha"/>
        <div class="card-body">
          <h5 class="card-title">Remolacha</h5>
          <h6>$4.600</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>
    </section>

      <h3>Granos</h3>

    <section class="product" class="product" data-id="17" data-name="frijoles" data-price="3.500" data-quantity="1">
      <div class="content">
          <img src="frijoles.jpg" class="card-img-top" alt="frijoles"/>
        <div class="card-body">
          <h5 class="card-title">Frijoles</h5>
          <h6>$3.500</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="18" data-name="lentejas" data-price="3.950" data-quantity="1">
          <img src="lentejas.jpg" class="card-img-top" alt="lentejas"/>
        <div class="card-body">
          <h5 class="card-title">lentejas</h5>
          <h6>$3.950</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="19" data-name="maiz" data-price="9.590" data-quantity="1">
          <img src="maiz.jpg" class="card-img-top" alt="maiz"/>
        <div class="card-body">
          <h5 class="card-title">Maiz</h5> 
          <h6>$9.590</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="20" data-name="arveja" data-price="5.990" data-quantity="1">
          <img src="arveja.jpg" class="card-img-top" alt="arveja"/>
        <div class="card-body">
          <h5 class="card-title">Arveja</h5>
          <h6>$5.990</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="21" data-name="arroz" data-price="10.950" data-quantity="1">
          <img src="arroz.jpg" class="card-img-top" alt="arroz"/>
        <div class="card-body">
          <h5 class="card-title">Arroz</h5>
          <h6>$10.950</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="22" data-name="trigo" data-price="4.100" data-quantity="1">
          <img src="trigo.jpg" class="card-img-top" alt="trigo"/>
        <div class="card-body">
          <h5 class="card-title">Trigo</h5>
          <h6>$4.100</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="23" data-name="arroz_integral" data-price="11.990" data-quantity="1">
        <img src="arroz_integral.jpg" class="card-img-top" alt="arroz_integral"/>
        <div class="card-body">
          <h5 class="card-title">Arroz_integral</h5>
          <h6>$11.990</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>

      <div class="content product" data-id="24" data-name="caraotas" data-price="3.550" data-quantity="1">
        <img src="caraotas.jpg" class="card-img-top" alt="caraotas"/>
        <div class="card-body">
          <h5 class="card-title">Caraotas</h5>
          <h6>$3.550</h6>
          <button class="boutton_add add-to-cart">Agregar</button>
        </div>
      </div>
    </section>
  </div>

    <footer class="footer">
      <div class="container">
        <div class="footer-row">
          <div class="footer-links">
            <h4>Legal</h4>
            <ul>
              <li><a href="Nosotros">Nosotros</a></li>
              <li><a href="TerminosCondiciones">Terminos y Condiciones</a></li>
              <li><a href="PoliticaPrivacidad">Politica y privacidad</a></li>
              <li><a href="https://www.sic.gov.co">Superintendencia de Industria y Comercio</a></li>
            </ul>
          </div>
          <div class="footer-links">
            <h4>Ayuda</h4>
            <ul>
              <li><a href="AyudaPreguntas">Ayuday Preguntas</a></li>
              <li><a href="contactanos">Contactanos</a></li>
            </ul>
          </div>
          <div class="footer-links">
            <h4>Siguenos</h4>
            <div class="Social-link">
              <a href="https://www.facebook.com/?locale=es_LA"><i class="fa-brands fa-facebook"></i></a>
              <a href="https://www.instagram.com/?hl=es-es"><i class="fa-brands fa-instagram"></i></a>
              <a href="https://twitter.com/?lang=es"><i class="fa-brands fa-twitter"></i></a>
              <a href="https://www.linkedin.com/feed/"><i class="fa-brands fa-linkedin"></i></a>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script>
      // Inicializamos el carrito vacío
      let cart = [];

      // Seleccionar todos los botones "Agregar"
      const addToCartButtons = document.querySelectorAll('.add-to-cart');

      // Añadir un event listener para capturar el clic en cada botón
      addToCartButtons.forEach(button => {
          button.addEventListener('click', event => {
              const productElement = event.target.closest('.product');

              const productId = productElement.dataset.id;
              const productName = productElement.dataset.name;
              const productPrice = parseFloat(productElement.dataset.price);

              // Verificar si ya existe el producto en el carrito
              const existingProduct = cart.find(item => item.id === productId);

              if (existingProduct) {
                  // Si el producto ya está en el carrito, mostrar un mensaje
                  alert('Este producto ya está en tu carrito. Puedes cambiar la cantidad desde el carrito.');
              } else {
                  // Si no existe, se agrega el producto al carrito
                  const product = { id: productId, name: productName, price: productPrice, quantity: 1 };
                  cart.push(product);
                  console.log("Carrito actualizado:", cart); // Verifica el carrito antes de enviarlo
                  sendCartToServer(cart); // Envía el carrito al servidor
              }
          });
      });

      function sendCartToServer(cart) {
          fetch('http://localhost:3036/add-to-cart', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json'
              },
              body: JSON.stringify({ cart }) // Enviamos el carrito como JSON
          })
          .then(response => {
              if (!response.ok) {
                  console.error("Error en la respuesta del servidor, estado: ", response.status);
                  return response.text(); // Leer el HTML si es un error 500
              }
              return response.json();
          })
          .then(data => {
              if (data.success) {
                  console.log("Carrito enviado correctamente:", data);
              } else {
                  console.error("Error al procesar el carrito en el servidor:", data.message);
              }
          })
          .catch(error => {
              console.error("Error al enviar los datos:", error);
          });
      }


    </script>
    
  
  
</body>
</html>